<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>个人学习笔记</title>
    <link>https://blog.emath.top/</link>
    <description>Recent content on 个人学习笔记</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 31 Dec 2023 17:04:19 +0800</lastBuildDate>
    
        <atom:link href="https://blog.emath.top/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>SSH应用与实践</title>
      <link>https://blog.emath.top/post/ops/ssh/</link>
      <pubDate>Sun, 31 Dec 2023 17:04:19 +0800</pubDate>
      
      <guid>https://blog.emath.top/post/ops/ssh/</guid>
      
        <description>&lt;p&gt;休完陪产假回到公司便听说了优化的事情，不禁感叹今年真的挺难的。无奈作为一名开发人员，又要开始兼职运维的工作，因此也顺便整理一下有关SSH的相关知识。&lt;/p&gt;
&lt;h2 id=&#34;一背景&#34;&gt;一、背景&lt;/h2&gt;
&lt;p&gt;Linux系统大多数情况下作为服务器而存在，服务的部署绕不开对Linux的操作，通过整理SSH知识点与实践笔记，可以完成对Linux系统的连接、实现跳板机、端口转发等目标。&lt;/p&gt;
&lt;h2 id=&#34;二安全远程登录&#34;&gt;二、安全远程登录&lt;/h2&gt;
&lt;h3 id=&#34;1-密码登录&#34;&gt;1. 密码登录&lt;/h3&gt;
&lt;h4 id=&#34;ssh服务默认登录方式原理如下&#34;&gt;SSH服务默认登录方式，原理如下：&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;客户端向服务端发起请求&lt;/li&gt;
&lt;li&gt;服务端收到请求将自己生成的公钥返回给客户端&lt;/li&gt;
&lt;li&gt;客户端使用返回的公钥加密登录密码并发送给服务端&lt;/li&gt;
&lt;li&gt;服务端使用对应的私钥解密，密码验证通过后，允许登录&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;基本使用&#34;&gt;基本使用：&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh username@remoteIP -p port
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;username@remoteIP&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;username : 远程机器的用户名&lt;/li&gt;
&lt;li&gt;remoteIP : 远程机器的地址（IP、域名 或者 别名）&lt;/li&gt;
&lt;li&gt;port : SSH服务端口号（默认值：22）&lt;/li&gt;
&lt;li&gt;password : 输入远程机器的密码&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;存在的问题&#34;&gt;存在的问题&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;安全性，存在中间人攻击的可能
&lt;ol&gt;
&lt;li&gt;客户端向服务端发起请求&lt;/li&gt;
&lt;li&gt;攻击人截获请求，并向客户端反回自己的公钥&lt;/li&gt;
&lt;li&gt;客户端使用返回的公钥加密登录密码并返回&lt;/li&gt;
&lt;li&gt;攻击人用自己的私钥解密，获得服务器登录信息（密码）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;较为麻烦，每次登录需要输入密码&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2-密钥认证登录&#34;&gt;2. 密钥认证登录&lt;/h3&gt;
&lt;h4 id=&#34;免密登录方式原理如下&#34;&gt;免密登录方式，原理如下：&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;客户端生成密钥对，事先将公钥上传存储至远程服务器上&lt;/li&gt;
&lt;li&gt;客户端发起登录请求&lt;/li&gt;
&lt;li&gt;服务器发一串随机字符串给客户端&lt;/li&gt;
&lt;li&gt;客户端使用私钥加密随机字符串并返回给服务端&lt;/li&gt;
&lt;li&gt;服务端用事先存好的公钥解密，确认字符串后，允许登录&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;实现步骤&#34;&gt;实现步骤&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;客户端通过ssh-keygen生成自己的公钥和私钥。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;生成一个4096位 RSA 加密算法的密钥对，并且给出了用户名和主机名。
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-keygen -t rsa -b &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; -C &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;your_email@domain.com&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上传公钥&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;手动：&lt;br&gt;
生成密钥以后，公钥必须上传到服务器，才能使用公钥登录。&lt;br&gt;
OpenSSH 规定，用户公钥保存在服务器的~/.ssh/authorized_keys文件.
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cat ~/.ssh/id_rsa.pub | ssh user@host &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;mkdir -p ~/.ssh &amp;amp;&amp;amp; cat &amp;gt;&amp;gt; ~/.ssh/authorized_keys&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;注意，authorized_keys文件的权限要设为644，即只有文件所有者才能写。如果权限设置不对，SSH 服务器可能会拒绝读取该文件。&lt;/li&gt;
&lt;li&gt;自动：&lt;br&gt;
OpenSSH 自带一个ssh-copy-id命令，可以自动将公钥拷贝到远程服务器的.
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-copy-id -i id_rsa username@remoteIP
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;登陆时，不指定私钥配置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vim ~/.ssh/config
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host *
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  IdentityFile ~/.ssh/your_private_key
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关闭密码登录&lt;br&gt;
对于 OpenSSH，具体方法就是打开服务器 sshd 的配置文件/etc/ssh/sshd_config，将PasswordAuthentication这一项设为no。
重启sshd&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;systemctl restart sshd.service
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;自启动配置：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;systemctl enable sshd.service
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;三文件传输&#34;&gt;三、文件传输&lt;/h2&gt;
&lt;h3 id=&#34;1-scp&#34;&gt;1. scp&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;复制远程文件至当前目录&lt;br&gt;
&lt;code&gt;scp username@remoteIP:/home/username/filename .&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;复制文件至远程目录&lt;br&gt;
&lt;code&gt;scp filename username@remoteIP:/home/username&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;基于&lt;code&gt;-r&lt;/code&gt;选项复制目录&lt;br&gt;
&lt;code&gt;scp -r source_dir username@remoteIP:/home/username/target_dir&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;配置项&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-C ：传输时压缩文件&lt;/li&gt;
&lt;li&gt;&amp;amp; ： 后台运行&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-rsync&#34;&gt;2. rsync&lt;/h3&gt;
&lt;p&gt;rsync不是SSH 工具集的一部分，是一个强大的文件同步工具，用于在本地或远程系统之间同步文件和目录，它能够差异化地传输文件，只传输发生变化的部分，从而节省带宽和时间。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;本地文件同步到远程主机&lt;br&gt;
&lt;code&gt;rsync -av source/ username@remoteIP:destination&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;远程文件同步到本地&lt;br&gt;
&lt;code&gt;rsync -av username@remoteIP:source/ destination&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3-sftp&#34;&gt;3. sftp&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;连接 FTP 主机&lt;br&gt;
&lt;code&gt;sftp username@remoteIP&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;本地文件传输到远程主机&lt;br&gt;
&lt;code&gt;put localfile [remotefile]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;远程文件传输到本地&lt;br&gt;
&lt;code&gt;get remotefile [localfile]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;4-sshfs&#34;&gt;4. sshfs&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;挂载远程文件系统&lt;br&gt;
&lt;code&gt;sshfs username@remoteIP:[远程路径] [本地挂载点]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;卸载远程文件系统&lt;br&gt;
&lt;code&gt;fusermount -u [本地挂载点]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;四端口转发&#34;&gt;四、端口转发&lt;/h2&gt;
&lt;h3 id=&#34;1-本地转发localforward&#34;&gt;1. 本地转发（LocalForward）&lt;/h3&gt;
&lt;p&gt;创建一个本地端口，将发往该端口的所有通信都通过 SSH 服务器，转发到指定的远程服务器的端口。SSH 服务器只是一个作为跳板的中介，用于连接本地计算机无法直接连接的远程服务器。本地转发是在本地计算机建立的转发规则。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh -L -N -f -g local-port:target-host:target-port username@sshIP  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-L：表示本地端口转发
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-N：不发送任何命令，只用来建立连接
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-f：将 SSH 连接放到后台
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-g：允许远程主机通过使用本地主机的IP地址访问
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;举例：&lt;code&gt;ssh -L -N -f -g 8080:localhost:80 root@192.168.2.30 &lt;/code&gt;&lt;br&gt;
此时访问127.0.0.1:8080 等于访问的是192.168.2.30:80&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果经常使用本地转发，可以将设置写入 SSH 客户端的用户个人配置文件（~/.ssh/config）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host myserver
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    HostName 192.168.2.30
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    User root
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    LocalForward &lt;span style=&#34;color:#ae81ff&#34;&gt;8080&lt;/span&gt; localhost:80
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;连接：&lt;code&gt;ssh myserver&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-远程转发-remoteforward&#34;&gt;2. 远程转发 (RemoteForward)&lt;/h3&gt;
&lt;p&gt;远程转发是通过远程 SSH 服务器访问本地计算机，可以作为内网穿透，当内网服务想被外网访问，可以通过远程转发将内网端口映射到具有公网IP的服务器的某个端口。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh -R -N remote-port:target-host:target-port  remotehost
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-R：表示远程端口转发
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-N：不发送任何命令，只用来建立连接
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;举例 &lt;code&gt;ssh -R 80:localhost:8080 -N root@www.emath.top&lt;/code&gt;
此时访问www.emath.top:80 等于访问的是localhost:80&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3-动态转发-dynamicforward&#34;&gt;3. 动态转发 (DynamicForward)&lt;/h3&gt;
&lt;p&gt;动态转发需要把本地端口绑定到 SSH 服务器。至于 SSH 服务器要去访问哪一个网站，完全是动态的，取决于原始通信。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh -D local-port username@remoteIP -N
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-D：表示动态转发
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-N：表示这个 SSH 连接只进行端口转发，不登录远程 Shell
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;举例 &lt;code&gt;ssh -D 1234 root@www.emath.top -N&lt;/code&gt;
注意，这种转发采用了 SOCKS5 协议。访问外部网站时，需要把 HTTP 请求转成 SOCKS5 协议，才能把本地端口的请求转发出去。&lt;/p&gt;
&lt;p&gt;访问：&lt;code&gt;curl -x socks5://localhost:1234 http://www.google.com&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;五总结&#34;&gt;五、总结&lt;/h2&gt;
&lt;h3 id=&#34;1-什么是ssh&#34;&gt;1. 什么是SSH&lt;/h3&gt;
&lt;p&gt;SSH（Secure Shell ）是一种网络安全协议，通过加密和认证机制实现安全的访问和文件传输等业务。传统远程登录和文件传输方式，例如Telnet、FTP，使用明文传输数据，存在很多的安全隐患。随着人们对网络安全的重视，这些方式已经慢慢不被接受。SSH协议通过对网络数据进行加密和验证，在不安全的网络环境中提供了安全的网络服务。作为Telnet和其他不安全远程shell协议的安全替代方案，目前SSH协议已经被全世界广泛使用，大多数设备都支持SSH功能。&lt;/p&gt;
&lt;h3 id=&#34;2-ssh用来做什么&#34;&gt;2. SSH用来做什么&lt;/h3&gt;
&lt;p&gt;用于保证远程登录和远程通信的安全，任何网络服务都可以用这个协议来加密，最常用的场景是远程登录和文件传输。
&lt;img src=&#34;images/ssh.png&#34; alt=&#34;安全传输&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;3-ssh-架构&#34;&gt;3. SSH 架构&lt;/h3&gt;
&lt;p&gt;SSH 的软件架构是服务器-客户端模式（Server - Client）。在这个架构中，SSH 软件分成两个部分：向服务器发出请求的部分，称为客户端（client），OpenSSH 的实现为 ssh；接收客户端发出的请求的部分，称为服务器（server），OpenSSH 的实现为 sshd&lt;/p&gt;
&lt;h3 id=&#34;4-工作流程&#34;&gt;4. 工作流程&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;建立TCP连接&lt;/li&gt;
&lt;li&gt;版本协商&lt;/li&gt;
&lt;li&gt;算法协商&lt;/li&gt;
&lt;li&gt;密钥交换&lt;/li&gt;
&lt;li&gt;用户认证&lt;/li&gt;
&lt;li&gt;会话请求&lt;/li&gt;
&lt;li&gt;会话交互&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;5-感悟&#34;&gt;5. 感悟&lt;/h3&gt;
&lt;p&gt;明天开始就是2024了，回忆这一年以来不论是生活还是工作确实都很难，希望自己能不忘初心，持续提升自我，肩负起家庭的责任、当代青年的社会责任。&lt;br&gt;
在未来的一年，学习笔记还是要坚持做的，加深自己对工作中常用的知识点的理解更是方便需要时的查阅。&lt;/p&gt;</description>
      
    </item>
    
    <item>
      <title>Node.js应用监控</title>
      <link>https://blog.emath.top/post/nodeapp/apm/</link>
      <pubDate>Sun, 05 Nov 2023 13:21:55 +0800</pubDate>
      
      <guid>https://blog.emath.top/post/nodeapp/apm/</guid>
      
        <description>&lt;p&gt;整理Node.js应用监控系统相关内容。&lt;/p&gt;
&lt;h2 id=&#34;一背景&#34;&gt;一、背景&lt;/h2&gt;
&lt;p&gt;为了能够很好定位线上问题，提前预知系统存在的隐患与问题，选择引入应用监控系统APM。&lt;/p&gt;
&lt;h2 id=&#34;二apm&#34;&gt;二、APM&lt;/h2&gt;
&lt;h3 id=&#34;1-概念&#34;&gt;1. 概念&lt;/h3&gt;
&lt;p&gt;Application Performance Management (APM) 是监控服务的一套技术手段，致力于监控并管理程序的性能和可用性。&lt;/p&gt;
&lt;h3 id=&#34;2-作用&#34;&gt;2. 作用&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;实时采集监控数据：包括硬件、操作系统、中间件、应用程序等各个维度的数据。&lt;/li&gt;
&lt;li&gt;实时反馈监控状态：通过对采集的数据进行多维度统计和可视化展示，能实时体现监控对象的状态是正常还是异常。&lt;/li&gt;
&lt;li&gt;预知故障和告警：能够提前预知故障风险，并及时发出告警信息。&lt;/li&gt;
&lt;li&gt;辅助定位故障：提供故障发生时的各项指标数据，辅助故障分析和定位。&lt;/li&gt;
&lt;li&gt;辅助性能调优：为性能调优提供数据支持，比如慢 SQL，接口响应时间等。&lt;/li&gt;
&lt;li&gt;辅助容量规划：为服务器、中间件以及应用集群的容量规划提供数据支撑。&lt;/li&gt;
&lt;li&gt;辅助自动化运维：为自动扩容或者根据配置的 SLA 进行服务降级等智能运维提供数据支撑。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;3-组成原理&#34;&gt;3. 组成原理&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Agent: 用于上报数据&lt;/li&gt;
&lt;li&gt;Monitor: 用于收集数据&lt;/li&gt;
&lt;li&gt;Dashboard: 用于展示数据&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;4-apm形态&#34;&gt;4. APM形态&lt;/h3&gt;
&lt;h4 id=&#34;41-服务器性能指标监控&#34;&gt;4.1 服务器性能指标监控&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;对服务依赖的硬件性能进行监控，如CPU、内存、硬盘容量。&lt;/li&gt;
&lt;li&gt;监控服务器性能指标的实时值，用于出紧急问题时及时报警。&lt;/li&gt;
&lt;li&gt;监控历史趋势，可以观察每天的访问情况及对异常点进行分析。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;42-服务监控&#34;&gt;4.2 服务监控&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;对提供的服务进行监控。&lt;/li&gt;
&lt;li&gt;检测服务情况，如请求数，响应数，成功率。&lt;/li&gt;
&lt;li&gt;监测服务的热点，异常波动。&lt;/li&gt;
&lt;li&gt;监测服务来源，调用方分布。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;43-错误异常监控&#34;&gt;4.3 错误异常监控&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;对报错或异常进行监控。&lt;/li&gt;
&lt;li&gt;一般需要主动上报。&lt;/li&gt;
&lt;li&gt;需要提供大量上下文信息才有意义，如当时的URL，错误堆栈等。&lt;/li&gt;
&lt;li&gt;价值与错误信息多少成正比。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;44-日志收集&#34;&gt;4.4 日志收集&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;对服务的所有情况进行记录，日志是必不可少的。&lt;/li&gt;
&lt;li&gt;日志查询分析困难，所以APM一般都有日志收集和分析能力。&lt;/li&gt;
&lt;li&gt;占空间，定期清理。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;45-依赖监控&#34;&gt;4.5 依赖监控&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;对服务的依赖进行监控，如数据库、缓存、外部服务。&lt;/li&gt;
&lt;li&gt;几乎所有的响应缓慢的问题均是依赖导致的。&lt;/li&gt;
&lt;li&gt;依赖监控比较大范围的监控，只能发现问题。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;46-分布式事务追踪&#34;&gt;4.6 分布式事务追踪&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;一个服务从发起到完成，要经历的节点。&lt;/li&gt;
&lt;li&gt;传统的只能监控多个节点无法串联。&lt;/li&gt;
&lt;li&gt;分布式追踪可以通过一个ID 就可以查询到一次请求的全链路情况。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;47-代码级监控分析profiling&#34;&gt;4.7 代码级监控分析（Profiling）&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;一般利用自动化的代码插桩技术，获取Node.js 进程内方法的调用链路。&lt;/li&gt;
&lt;li&gt;可以查看调用栈上的总执行时间和每个方法占的百分比。&lt;/li&gt;
&lt;li&gt;结合 V8 Profiling , 查看可能出现的内存泄漏情况。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;三指标&#34;&gt;三、指标&lt;/h2&gt;
&lt;h3 id=&#34;1-use-method-概念&#34;&gt;1. Use Method 概念&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;资源： 应用依赖的硬件资源（CPU、硬盘、内存）&lt;/li&gt;
&lt;li&gt;Utilization（利用率）： 以资源的一个时间段内被使用的百分比。&lt;/li&gt;
&lt;li&gt;Saturation（饱和度）：某个资源排队的数量。&lt;/li&gt;
&lt;li&gt;Errors（误差/错误数）：出现异常的数量。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2-cpu利用率&#34;&gt;2. CPU利用率&lt;/h3&gt;
&lt;h3 id=&#34;3-内存泄露&#34;&gt;3. 内存泄露&lt;/h3&gt;
&lt;h3 id=&#34;4-吞吐量-qps--tps&#34;&gt;4. 吞吐量 QPS &amp;amp; TPS&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;QPS ： 是一台服务器每秒能够查询的次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。&lt;/li&gt;
&lt;li&gt;TPS ： 是一台服务器每秒能够处理事务的次数。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;3-峰值qps&#34;&gt;3. 峰值QPS：&lt;/h3&gt;
&lt;p&gt;每天80%的访问集中在20%的时间里，这20%时间叫做峰值时间。&lt;br&gt;
（总PV数 * 80%） / （每天秒数 * 20% ） =  峰值时间每秒请求数（QPS）&lt;/p&gt;
&lt;h3 id=&#34;5-rt--concurrencyapdex&#34;&gt;5. RT 、 Concurrency、APDEX&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;RT（响应时间）：执行一个请求从开始到最后收到响应数据所花费的总体时间。&lt;/li&gt;
&lt;li&gt;Concurrency（并发数）：是指系统同时能处理的请求数量。&lt;/li&gt;
&lt;li&gt;APDEX：性能指数 ， 性能满意度的量化值。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;四graphite--grafana-实践&#34;&gt;四、Graphite &amp;amp; Grafana 实践&lt;/h2&gt;
&lt;h3 id=&#34;1-graphite&#34;&gt;1. Graphite&lt;/h3&gt;
&lt;p&gt;是处理可视化和指标数据的优秀开源工具。有强大的查询API 和 相当丰富的插件功能设置。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;指标采集器 metrics 用于采集数据。&lt;/li&gt;
&lt;li&gt;监听器 carbon 接受指标采集器收集上来的数据，做聚合计算。&lt;/li&gt;
&lt;li&gt;存储数据库 whisper 用于存储按照时间序列的数据。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2-grafana&#34;&gt;2. Grafana&lt;/h3&gt;
&lt;p&gt;是一款用Go语言开发的开源数据可视化工具，可以做数据监控和数据统计，带有告警功能，界面美观，定制性强。&lt;/p&gt;
&lt;h3 id=&#34;3-实践&#34;&gt;3. 实践&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Graphite &amp;amp; Grafana docker-compose.yml 文件
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;version&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;services&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;grafana&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;grafana/grafana&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;ports&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      - &lt;span style=&#34;color:#ae81ff&#34;&gt;3000&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;3000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;graphite-statsd&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;graphiteapp/graphite-statsd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;ports&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      - &lt;span style=&#34;color:#ae81ff&#34;&gt;2003-2004&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;2003-2004&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      - &lt;span style=&#34;color:#ae81ff&#34;&gt;2023-2024&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;2023-2024&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      - &lt;span style=&#34;color:#ae81ff&#34;&gt;8125&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;8125&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;/udp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      - &lt;span style=&#34;color:#ae81ff&#34;&gt;8126&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;8126&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      - &lt;span style=&#34;color:#ae81ff&#34;&gt;8080&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;测试代码 app.js
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;express&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;express&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;express&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;expressStatsd&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;express-statsd&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#75715e&#34;&gt;//指标上报工具
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;use&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;expressStatsd&lt;/span&gt;());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;statsd&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;path&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;next&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;method&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;method&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;unknown_method&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;statsdKey&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;method&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;toLowerCase&lt;/span&gt;(), &lt;span style=&#34;color:#a6e22e&#34;&gt;path&lt;/span&gt;].&lt;span style=&#34;color:#a6e22e&#34;&gt;join&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;next&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;statsd&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;root&amp;#34;&lt;/span&gt;), (&lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;) =&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;between&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;status&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;500&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;send&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;send&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Response from a simple GET API&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;});
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;listen&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;8000&lt;/span&gt;, () =&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Node server started on port 8000&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;});
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;between&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;min&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;max&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Math.&lt;span style=&#34;color:#a6e22e&#34;&gt;floor&lt;/span&gt;(Math.&lt;span style=&#34;color:#a6e22e&#34;&gt;random&lt;/span&gt;() &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;max&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;min&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;min&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;启动Graphite &amp;amp; Grafana 监控平台 docker-compose up -d&lt;/li&gt;
&lt;li&gt;启动 app.js node app.js&lt;/li&gt;
&lt;li&gt;此时访问  http://localhost:8000/ 便会将数据上传至监控平台&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;4-grafana配置&#34;&gt;4. Grafana配置&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;登陆 grafana （http://localhost:3000/）&lt;br&gt;
默认用户名/密码： admin/admin&lt;/li&gt;
&lt;li&gt;Add data source
Connections &amp;gt; Data sources &amp;gt; Add data source  &amp;gt; 选择Graphite &amp;gt; 填写URL &amp;gt; Save&lt;br&gt;
&lt;img src=&#34;images/add-data-source.png&#34; alt=&#34;追加dataSource&#34;&gt;&lt;/li&gt;
&lt;li&gt;配置报表&lt;br&gt;
Dashboards &amp;gt; New dashboard &amp;gt; Add visualization &amp;gt; Select data source (Graphite)&lt;br&gt;
配置：Series&lt;br&gt;
保存：save&lt;br&gt;
&lt;img src=&#34;images/config-dashboard.png&#34; alt=&#34;配置报表&#34;&gt;&lt;/li&gt;
&lt;li&gt;查看结果&lt;br&gt;
&lt;img src=&#34;images/dashboard-result.png&#34; alt=&#34;查看结果&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;五总结&#34;&gt;五、总结&lt;/h2&gt;
&lt;p&gt;引入APM以实现：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;了解终端用户真实体验。&lt;/li&gt;
&lt;li&gt;应用架构映射，从监控逆向分析出真实链路。&lt;/li&gt;
&lt;li&gt;应用事务分析，能从一个唯一的线索找出整条事务或操作。&lt;/li&gt;
&lt;li&gt;深度应用诊断，精准定位问题。&lt;/li&gt;
&lt;li&gt;分析与报告，提供实时精准的大数据查询和可视化&lt;/li&gt;
&lt;/ol&gt;</description>
      
    </item>
    
    <item>
      <title>Node.js开篇</title>
      <link>https://blog.emath.top/post/node/begin/</link>
      <pubDate>Sun, 29 Oct 2023 19:51:19 +0800</pubDate>
      
      <guid>https://blog.emath.top/post/node/begin/</guid>
      
        <description>&lt;p&gt;记录 Node.js 的第一篇博客，主要记录了Node.js的组成与特点。&lt;/p&gt;
&lt;h2 id=&#34;一nodejs简介&#34;&gt;一、Node.js简介&lt;/h2&gt;
&lt;p&gt;Node.js是开源跨平台的JavaScript运行环境。基于chrome V8引擎、Libuv库及第三方模块实现的单线程应用。&lt;/p&gt;
&lt;p&gt;其组成架构图如下图：
&lt;img src=&#34;images/architecture.png&#34; alt=&#34;组成架构&#34;&gt;&lt;/p&gt;
&lt;p&gt;整体分为3个部分：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Node.js 标准库：&lt;/strong&gt; &lt;br&gt;
这部分由 JavaScript 编写的 Node.js 核心模块，供使用者直接引用，位于源码的lib目录。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Node Bingdings：&lt;/strong&gt;&lt;br&gt;
Node.js 程序的 main 函数入口，对底层模块进行封装为标准库提供C++类接口，是 JavaScript 与底层 C/C++ 沟通的桥梁，由 C++ 编写，位于源码的 src 目录。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;最底层：&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;V8 引擎：&lt;/strong&gt; 用于解析、执行 JavaScrpit 代码的运行环境。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;libuv：&lt;/strong&gt; 提供底层I/O操作接口，包括文件异步I/O线程池和网络的I/O操作，是整个异步I/O实现的核心，由 C/C++ 编写，位于源码的 deps 目录。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;其他 C/C++ 组件和库&lt;/strong&gt;：如 c-ares、http_parser 等，这些依赖提供了对系统底层功能的访问。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;二特点&#34;&gt;二、特点&lt;/h2&gt;
&lt;h3 id=&#34;1-单线程&#34;&gt;1. 单线程&lt;/h3&gt;
&lt;p&gt;传统的 web 服务模型中，大多都使用多线程来解决并发问题。会为每个客户端连接创建一个新的线程，每个线程大约需要消耗2MB内存。理论上，一个8GB内存的服务器可以同时连接最大的用户数为4000个左右。Node.js只有一个主线程，当用户连接时会触发一个内部事件，通过非阻塞I/O、事件驱动机制，实现Node.js程序的并行，一个8GB内存的服务器，可以同时处理4万用户的连接。&lt;/p&gt;
&lt;p&gt;优点：操作系统不再有线程创建、销毁的开销。&lt;/p&gt;
&lt;p&gt;缺点：一个代码某个环节崩溃会导致整个系统的崩溃。&lt;/p&gt;
&lt;h3 id=&#34;2-非阻塞io&#34;&gt;2. 非阻塞I/O&lt;/h3&gt;
&lt;p&gt;Node.js 采用了非阻塞I/O。例如，像是执行了访问数据库的代码后，将立即执行后面的代码，将数据库返回结果交由回调函数处理，从而提高了程序执行效率。当某个I/O执行完成后，将以事件的形式通知执行I/O操作的线程，线程执行这个事件的回调函数，为了处理异步I/O，线程必须有事件循环，不断的检查有没有未处理的事件，依次处理。&lt;/p&gt;
&lt;p&gt;相反，阻塞模式下，一个线程只能处理一项任务，想要提高吞吐量必须通过多线程的方式。&lt;/p&gt;
&lt;h3 id=&#34;3-事件驱动&#34;&gt;3. 事件驱动&lt;/h3&gt;
&lt;p&gt;在Node.js中，客户端请求建立连接、调用接口等行为会触发相应的事件。
&lt;img src=&#34;images/eventLoop.png&#34; alt=&#34;事件循环&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;31-主线程&#34;&gt;3.1 主线程&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;main：启动入口文件，运行主函数。&lt;/li&gt;
&lt;li&gt;event pool：检查是否要进入事件循环。
&lt;ul&gt;
&lt;li&gt;检查其他线程里是否还有待处理事项。&lt;/li&gt;
&lt;li&gt;检查其他任务是否还在进行中（比如计时器、文件读取操作等任务是否完成）。&lt;/li&gt;
&lt;li&gt;有以上情况，进入事件循环，运行其他任务。
事件循环的过程：从timer 至 close callbacks整个流程走完，到event loop检查是否结束，没结束继续走一圈。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;over：所有事件都结束。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;32-事件循环&#34;&gt;3.2 事件循环&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;images/eventLoopFlow.png&#34; alt=&#34;事件循环流程图&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;三nodejs适用场景&#34;&gt;三、Node.js适用场景&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;I/O密集型场景&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RestFul API&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RPC 服务&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BBF&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Serverless&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;微服务&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;</description>
      
    </item>
    
    <item>
      <title>基于HUGO搭建个人静态博客</title>
      <link>https://blog.emath.top/post/hugo/hugoblog/</link>
      <pubDate>Fri, 20 Oct 2023 22:29:17 +0800</pubDate>
      
      <guid>https://blog.emath.top/post/hugo/hugoblog/</guid>
      
        <description>&lt;p&gt;记录使用hugo如何快速搭建个人博客在本地运行，记录hugo相关内容作为日后使用及扩展做好准备。&lt;/p&gt;
&lt;h2 id=&#34;一hugo&#34;&gt;一、HUGO&lt;/h2&gt;
&lt;h3 id=&#34;1-简介&#34;&gt;1. 简介&lt;/h3&gt;
&lt;p&gt;HUGO是基于Go编写的静态博客生成器，它能够将我们使用markdown格式写的文本内容快速的转换为HTML文档，并启动web服务，即可在浏览器中展示。&lt;/p&gt;
&lt;h3 id=&#34;2-感受&#34;&gt;2. 感受&lt;/h3&gt;
&lt;p&gt;它吸引我的地方在于其转换的速度，等后面正式上手后，又觉得整个搭建过程很简单很流畅。最让我纠结的地方就在于选主题了，总希望能找到一个简约、清爽的主题，最后还是做了小小的妥协，先完成整个搭建流程，再多写上几篇文章之后再花时间挑选或改造也不迟。&lt;/p&gt;
&lt;h3 id=&#34;3-原理&#34;&gt;3. 原理&lt;/h3&gt;
&lt;p&gt;一个静态博客框架，基于模版，将markdown文档转换为html文档。
&lt;img src=&#34;./images/hugo_schematic.png&#34; alt=&#34;原理&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;二快速使用&#34;&gt;二、快速使用&lt;/h2&gt;
&lt;p&gt;参照以下几个步骤，很快便可以实现个人博客的本地服务，总体而言稍微费时的便是选择中意的主题，其次是参照主题示例（exampleSite），配置hugo.toml文件以实现个人博客的个性化配置。当搭建好了个人博客的整体的架子后，往后的工作也只需要关心内容的输出，不断的创建新的文章即可。&lt;/p&gt;
&lt;h3 id=&#34;1-安装hugo&#34;&gt;1. 安装hugo&lt;/h3&gt;
&lt;p&gt;基于macos的安装方式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;//执行安装命令
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install hugo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;//查看安装结果
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo version
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo v0.119.0-b84644c008e0dc2c4b67bd69cccf87a41a03937e
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;2-创建站点&#34;&gt;2. 创建站点&lt;/h3&gt;
&lt;p&gt;创建一个名为blog的站点：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;//执行命令
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo new site blog
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;3-选择主题&#34;&gt;3. 选择主题&lt;/h3&gt;
&lt;p&gt;在&lt;a href=&#34;https://themes.gohugo.io/&#34;&gt;主题网址&lt;/a&gt;中选择一个符合自己审美的主题，简单比较了几个，确定了&lt;a href=&#34;https://github.com/xianmin/hugo-theme-jane&#34;&gt;jane&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd blog
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;//初始化git 仓库
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git init
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;//安装主题
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git submodule add https://github.com/xianmin/hugo-theme-jane themes/jane
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;4-修改配置&#34;&gt;4. 修改配置&lt;/h3&gt;
&lt;p&gt;将themes/jane/exampleSite/config.toml内容复制到hugo.toml文件中，开始按需更改。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; cp themes/jane/exampleSite/config.toml hugo.toml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;5-创建文章&#34;&gt;5. 创建文章&lt;/h3&gt;
&lt;p&gt;创建第一篇属于自己的文章&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;//执行命令
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo new post/title.md
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以开始专注于写内容了。
当然如果想快速看效果，也可以将themes/jane/exampleSite/content内容复制到 content目录中。&lt;/p&gt;
&lt;h3 id=&#34;6-查看效果&#34;&gt;6. 查看效果&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;//执行命令
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo server -D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;打开网址 http://localhost:1313/ 即可查看效果&lt;/p&gt;
&lt;h2 id=&#34;项目简介&#34;&gt;项目简介&lt;/h2&gt;
&lt;p&gt;参照上述步骤完成了博客的搭建，下面记录一下项目目录结构及关键文件的作用，方便更好的创作及整个博客主题内容的按需扩展。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tree -a -L &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── .git                   //git init 是生成的与文件夹，存放git版本信息。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── .gitignore             //此文件用来制定哪些文件或文件夹不受版本控制，白话点就是不想提交至git仓库点文件在这里指定，后文会用到它。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── .gitmodules            //用于管理子模块，比如主题就用到了submodules。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── .hugo_build.lock       //用于控制多个hugo实例的并发。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── archetypes             //hugo new xxx.md 依据此目录下的模板生成 xxx.md 的头部信息，像 title、date 等。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   └── default.md
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── assets                 //用于存放js、css等资源。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   └── jsconfig.json
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── config                 //用于设置不同环境的配置信息，像不同环境的hugo.toml，启动时需要指定环境，eg: hugo --environment staging。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   └── staging
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── content                //文章内容目录，hugo new xxx.md 生成文件的位置，创作内容存放于此。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   ├── about.md
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   └── post
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│       ├── hugo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│       └── origin.md
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── data                   //存放数据模版，既可以是静态数据，还可以是一些动态数据，通过URL获取。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── hugo.toml              //全局配置文件，配置整个站点信息。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── i18n                   //多语言配置表，当网址支持多国语言时的变量配置。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── layouts                //存放用来将content、data等资源渲染为完整网站的模板文件。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── public                 //执行hugo命令会将内容渲染为网站，网站内容便存放在public目录下即静态博客。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── resources              //存放缓存的css与images文件。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   └── _gen
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│       └── assets
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── static                 //存放静态资源，渲染时会将文件内容复制到public目录下。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   ├── favicon.ico
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   ├── googleddf7a5b53f538ab8.html
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   └── images
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;└── themes                 //主题目录，可以存放一个或多个主题。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    └── jane
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;1-content&#34;&gt;1. content&lt;/h3&gt;
&lt;p&gt;内容创作目录，当创建文章时就是在此目录下生成相应的markdown文件，当我们的文章中需要引入一些静态文件，比如图片，也可以存放在该目录下，方便文章引用。&lt;/p&gt;
&lt;p&gt;这里对我们有个小小的要求，就是需要掌握markdown的语法，其实也很简单，后面会考虑整理一份关于markdown语法整理的文档，便于自己快速查阅。&lt;/p&gt;
&lt;p&gt;还有一个需要引起思考的话题就是我们在什么地方进行初次创作，然后再将内容贴到该目录下。这里可以是类似飞书文档但是需要进行一些转换，这个能否基于什么工具进行转换为markdown文件，或者直接使用markdown编辑器，像是Typora。&lt;/p&gt;
&lt;h3 id=&#34;2-archetypes&#34;&gt;2. archetypes&lt;/h3&gt;
&lt;p&gt;用来定义创建文章的模板文件夹。当我们使用 &lt;code&gt;hugo new xxx.md&lt;/code&gt; 命令时，便会依据此目录下的模板文件（default.md）生成 xxx.md 文件，此模板文件可以预定一些变量信息。&lt;br&gt;
下面列举一些常用的变量：&lt;br&gt;
详细参照&lt;a href=&#34;https://gohugo.io/content-management/front-matter/#front-matter-variables&#34;&gt;官网内容&lt;/a&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;变量名&lt;/th&gt;
&lt;th&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;date&lt;/td&gt;
&lt;td&gt;文章创建时间&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;description&lt;/td&gt;
&lt;td&gt;文章描述&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;draft&lt;/td&gt;
&lt;td&gt;当设置为true时，标记为草稿内容，文章将不会显示&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;layout&lt;/td&gt;
&lt;td&gt;指定文章选择的布局，否则按照默认顺序选择布局&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;weight&lt;/td&gt;
&lt;td&gt;文章权重，从1开始，越小权重越大，排序越靠前&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;当我们的博客内容足够丰富时，不同类型的博客可能需要不同的模板，此时我们便可以创建除default.md以外的模板，比如我们可以在该目录下创建了一个名为post.md的模板。&lt;/p&gt;
&lt;p&gt;当我们执行&lt;code&gt;hugo new post/xxx.md&lt;/code&gt;时，hugo会按照以下顺序确定最终模板来创建xxx.md文件。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;archetypes/post.md&lt;/li&gt;
&lt;li&gt;themes/jane/archetypes/posts.md&lt;/li&gt;
&lt;li&gt;archetypes/default.md&lt;/li&gt;
&lt;li&gt;themes/jane/archetypes/default.md&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如果上述几个文件都不存在，就由内置默认模版兜底。&lt;/p&gt;
&lt;h2 id=&#34;四常用命令&#34;&gt;四、常用命令&lt;/h2&gt;
&lt;h3 id=&#34;1-添加文章&#34;&gt;1. 添加文章&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo new content path/title.md
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;2-构建网站&#34;&gt;2. 构建网站&lt;/h3&gt;
&lt;p&gt;在本地开发与测试阶段，需要用该命令以启动http服务，并支持热加载。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo server
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;3-部署网站&#34;&gt;3. 部署网站&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;参数：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    指定 baseURL：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -b baseURL 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    指定环境变量：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -e env 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    指定主题：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -t theme 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    编译草稿文章（draft:true）：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -D 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    编译已过期文章（expiryDate &amp;lt; now）：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -E 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    编译未来发布文章（publishDate &amp;gt; now）：
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -F 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;五尾注&#34;&gt;五、尾注&lt;/h2&gt;
&lt;p&gt;这篇文章与我而言其价值在于，先简单记录了基于hugo搭建博客的流程，基于此流程可以更加快速的完成博客的搭建。其次整理了hugo的目录结构，让我对hugo的功能边界及其原理有了初步的认识，为日后能够舒服的使用hugo埋下伏笔，更为日后改善博客主题样式做好了铺垫。当然，我很满意它的构建速度，也想在未来的时候能够去扩展，丰富我的个人博客。希望能够不负当初的愿望，真正实现帮助我学习提升。&lt;/p&gt;
&lt;p&gt;下一篇内容，计划是梳理关于如何将个人博客部署到网站托管平台。&lt;/p&gt;</description>
      
    </item>
    
    <item>
      <title>个人博客缘起</title>
      <link>https://blog.emath.top/post/origin/</link>
      <pubDate>Tue, 17 Oct 2023 22:10:59 +0800</pubDate>
      
      <guid>https://blog.emath.top/post/origin/</guid>
      
        <description>&lt;p&gt;记录自己为什么要写博客及围绕博客这个主题将会做些什么。&lt;/p&gt;
&lt;h2 id=&#34;先提问再起笔&#34;&gt;先提问再起笔&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;为什么要搭建个人博客？&lt;/li&gt;
&lt;li&gt;会不会是三分钟热度？&lt;/li&gt;
&lt;li&gt;考虑好记录哪些内容？&lt;/li&gt;
&lt;li&gt;对于技术选型有哪些思考？&lt;/li&gt;
&lt;li&gt;有哪些期望和目标？&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;思而答&#34;&gt;思而答&lt;/h2&gt;
&lt;h3 id=&#34;为什么要搭建个人博客&#34;&gt;为什么要搭建个人博客&lt;/h3&gt;
&lt;p&gt;首先，搭建博客既有内因也有外因。&lt;/p&gt;
&lt;p&gt;外因：当前的就业环境并不理想，竞争压力大，可生活压力更大，失业的囧境不敢想象。也受很多博主文章的影响，像是“不要高估一年的成长，更不要低估十年的成长”。外在环境在不断的牵引着我要去学习，去积累，去沉淀。&lt;/p&gt;
&lt;p&gt;内因：自己本身对研究技术，搭建博客等感兴趣，再者，也不想业余时间沉浸在抖音之类的娱乐上自我消磨。去实践，去将自己学到的，想学的及生活中的感悟记录在册，方便日后查阅。我相信最好的学习方式是输入的同时快速输出实践，否则很难进一步的理解以及容易忘却。&lt;/p&gt;
&lt;p&gt;综上，个人博客的实践应运而生。&lt;/p&gt;
&lt;h3 id=&#34;会不会是三分钟热度&#34;&gt;会不会是三分钟热度&lt;/h3&gt;
&lt;p&gt;确实，很多时候我是三分钟热度，业余生活中容易被其他事情影响，而放弃原本想坚持的事情。我也想通过此方式，告诫自己要养成坚持初心的习惯。不断学习，不断实践，不断记录。&lt;/p&gt;
&lt;h3 id=&#34;考虑好记录哪些内容&#34;&gt;考虑好记录哪些内容&lt;/h3&gt;
&lt;p&gt;目前，想记录内容总体分为三大类吧，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;技术实践&lt;/li&gt;
&lt;li&gt;学习笔记&lt;/li&gt;
&lt;li&gt;生活感悟&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;希望养成边学边练边输出的习惯，助力自己更好的学习各项技能。&lt;/p&gt;
&lt;h3 id=&#34;对于技术选型有哪些思考&#34;&gt;对于技术选型有哪些思考&lt;/h3&gt;
&lt;p&gt;目前选择了静态博客的方式，因为想快速看到效果，而不是自己花时间去从头搭建一套CMS，当然未来有可能去做这件事。通过hugo快速生成静态页面，通过GitHub Action 串联 GitHub page 的方式，实现一键式部署的方式，边玩边学的心态。&lt;/p&gt;
&lt;h3 id=&#34;有哪些期望和目标&#34;&gt;有哪些期望和目标&lt;/h3&gt;
&lt;p&gt;至于期望与目标，短期来看，就想通过这样一种方式养成持续学习的习惯，达到深入理解知识点的目的。明确目标，对系统架构的理解、对基础知识的掌握、对典型应用场景的技术选型有一定的梳理与记录。&lt;/p&gt;
&lt;h2 id=&#34;结语&#34;&gt;结语&lt;/h2&gt;
&lt;p&gt;锲而舍之，朽木不折；锲而不舍，金石可镂。&lt;/p&gt;</description>
      
    </item>
    
    <item>
      <title>实现个人静态博客的全网访问</title>
      <link>https://blog.emath.top/post/hugo/deployblog/</link>
      <pubDate>Sun, 22 Oct 2023 20:37:40 +0800</pubDate>
      
      <guid>https://blog.emath.top/post/hugo/deployblog/</guid>
      
        <description>&lt;p&gt;记录通过Vercel及GitHub Pages两种方式实现静态博客的部署及实现网站被搜索引擎收录，是上文&lt;a href=&#34;../hugoblog/&#34;&gt;基于HUGO搭建个人静态博客&lt;/a&gt;的后续工作。&lt;/p&gt;
&lt;h2 id=&#34;一背景&#34;&gt;一、背景&lt;/h2&gt;
&lt;p&gt;写博客的初衷，首先是方便自己查阅其次是可以给大家提供参考，所以需要将自己在本地搭建好的服务部署至云平台，方便随时访问。&lt;/p&gt;
&lt;p&gt;首先想到的是GitHub Pages，从Github源码仓库中直接创建网站，不过考虑到国内访问GitHub Pages的速度等原因，它无法作为我的首选。其次是部署到自己的云服务器上，但存在配置低且资源有限的情况。最后选择了免费网站托管平台Vercel。&lt;/p&gt;
&lt;h2 id=&#34;二基于vercel部署静态博客&#34;&gt;二、基于Vercel部署静态博客&lt;/h2&gt;
&lt;h3 id=&#34;1-vercel简介&#34;&gt;1. Vercel简介&lt;/h3&gt;
&lt;p&gt;Vercel是一个云服务平台，支持静态和动态网站的部署和上线，当集成GitHub后便可实现当代码推送至GitHub仓库后，自动部署上线网站。具有以下优势：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;个人版免费，并提供免费域名及Https证书。&lt;/li&gt;
&lt;li&gt;内置黑盒CI/CD，无需过多配置即可实现自动集成部署。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2-准备工作&#34;&gt;2. 准备工作&lt;/h3&gt;
&lt;p&gt;将自己在本地&lt;a href=&#34;../hugoblog/&#34;&gt;基于HUGO搭建个人静态博客&lt;/a&gt;项目blog推送至GitHub仓库。
具体步骤如下：&lt;br&gt;
&lt;strong&gt;1. 登陆GitHub创建一个私有仓库blog。&lt;/strong&gt;&lt;br&gt;
拿到仓库地址:https://github.com/youself/blog.git&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. .gitignore文件中添加public目录。&lt;/strong&gt; &lt;br&gt;
public目录作为hugo转换生成的结果，不能作为源码提交至Github。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. 删除themes/jane目录下的.git文件。&lt;/strong&gt;&lt;br&gt;
jane是从Github上clone下来的，会有.git文件，推送代码时内层目录有.git文件，会被识别为另一个git仓库并不会上传该目录只会上传一个软链文件，这样会影响Vercel拉取主题信息从而导致转换失败。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. 到本地blog项目目录下，依次执行执行以下命令，推送代码至远程仓库。&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 1.添加远程仓库
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git add remote origin https://github.com/youself/blog.git
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 2.拉取远程代码（创建时可能会生成一个 README.md 文件）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git pull
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 3.本地代码添加到暂存区
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git add .
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 4.提交代码
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git commit -m &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;第一次提交&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// 5.推送至远程仓库
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git push
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;3-实践步骤&#34;&gt;3. 实践步骤&lt;/h3&gt;
&lt;h4 id=&#34;基本步骤&#34;&gt;基本步骤：&lt;/h4&gt;
&lt;p&gt;按照下面步骤即可完成blog在Vercel平台的部署，Vercel会自动给我们分配域名，使用提供的网址即可访问。&lt;br&gt;
&lt;strong&gt;1. 注册 &lt;a href=&#34;https://vercel.com/signup&#34;&gt;Vercel&lt;/a&gt; 账号&lt;/strong&gt;&lt;br&gt;
选择 Hobby 类型 &amp;gt; 输入名称 &amp;gt; 下一步 &amp;gt; 使用GitHub账号认证即可。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. 新建项目&lt;/strong&gt;&lt;br&gt;
Add New &amp;gt; Project&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. 导入Git仓库&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. 导入知道项目blog&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5. 配置项目&lt;/strong&gt;&lt;br&gt;
选择框架Hugo &amp;gt; 构建命令 &lt;code&gt;hugo&lt;/code&gt; &amp;gt; 输出目录public &amp;gt; 环境变量添加HUGO_VERSION:(hugo version 结果) &amp;gt; 部署&lt;br&gt;
&lt;img src=&#34;./images/vercel_config.png&#34; alt=&#34;Vercel配置&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;使用自己域名&#34;&gt;使用自己域名：&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;1. 选择刚刚部署的项目&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;2. 点击Domain进入Domain设置页面&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;3. 输入事先准备的CNAME类型的域名&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;4. 点击Add&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;完成上述步骤即可使用自己的域名访问Vercel上部署的博客。&lt;/p&gt;
&lt;h3 id=&#34;4-总结&#34;&gt;4. 总结&lt;/h3&gt;
&lt;p&gt;至此，我们已经完成个人博客的云部署任务，也实现了个人静态博客的全网访问。简单上手体验了Vercel不禁想给它点赞，主要在以下几个方面，一是部署简单，二是访问快速，最后它还完全免费。&lt;/p&gt;
&lt;h2 id=&#34;三基于github-pages部署静态博客&#34;&gt;三、基于GitHub Pages部署静态博客&lt;/h2&gt;
&lt;h3 id=&#34;1-选择原因&#34;&gt;1. 选择原因&lt;/h3&gt;
&lt;p&gt;既然已经选择了Vercel，理论上云部署的任务已经完成，为什么又选择了GitHub Pages？&lt;/p&gt;
&lt;p&gt;是的，Vercel已经帮我实现了目标且很方便，选择GitHub Pages是因为GitHub Action，我没有用过它。之前接触CI/CD的流水线是基于其他仓库及其他工具，所以我想利用这个机会亲自实践感受一下GitHub Action。&lt;/p&gt;
&lt;h3 id=&#34;2-实践步骤&#34;&gt;2. 实践步骤&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;1. 创建一个以{用户名}.github.io命名的公有仓库。&lt;/strong&gt; &lt;br&gt;
该仓库不能选择私有仓库否则将无法访问。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. 创建GitHub个人访问令牌。&lt;/strong&gt;&lt;br&gt;
登陆GitHub &amp;gt; 点击用户头像 &amp;gt; Settings &amp;gt; Developer Settings &amp;gt; Personal access tokens &amp;gt; Tokens &amp;gt; Generate new token (classic)&amp;gt; 输入密码 &amp;gt; 输入 Token name 、 Expiration &amp;gt; 勾选repo及workflow权限 &amp;gt;  Generate token &amp;gt; 复制&lt;strong&gt;令牌&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. 为私有仓库blog创建Action secrets&lt;/strong&gt;&lt;br&gt;
打开私有库 &amp;gt; Settings &amp;gt; Secrets and variables &amp;gt; Actions &amp;gt; New repository Secrets&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Name : ACCESS_TOKEN&lt;/li&gt;
&lt;li&gt;Secret : 令牌&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;点击 Add secret 即可生成。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. 为私有仓库blog创建Action&lt;/strong&gt;&lt;br&gt;
打开私有库 &amp;gt; Action &amp;gt; New workflow &amp;gt;  set up a workflow yourself&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5. 编辑main.yml文件并提交&lt;/strong&gt;&lt;br&gt;
可以给该文件重命名，下面为参考模板。将模板内容修改好后提交，就会在yourname.github.io仓库生成一个新的分支gh-pages，并将转换的public目录下的文件推送至该分支。以后每次往私有库main分支提交代码都会触发该事件，将最新生成的博客更新至yourname.github.io仓库。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;GitHub Pages&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;on&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;push&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;branches&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         - &lt;span style=&#34;color:#ae81ff&#34;&gt;main &lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# 博客根目录的默认分支，这里是main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;pull_request&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;jobs&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;deploy&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;runs-on&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;ubuntu-20.04&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;concurrency&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#f92672&#34;&gt;group&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${{ github.workflow }}-${{ github.ref }}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;steps&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         - &lt;span style=&#34;color:#f92672&#34;&gt;uses&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;actions/checkout@v2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           &lt;span style=&#34;color:#f92672&#34;&gt;with&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#f92672&#34;&gt;submodules&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#f92672&#34;&gt;fetch-depth&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Setup Hugo&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           &lt;span style=&#34;color:#f92672&#34;&gt;uses&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;peaceiris/actions-hugo@v2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           &lt;span style=&#34;color:#f92672&#34;&gt;with&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#f92672&#34;&gt;hugo-version&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0.119.0&amp;#39;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;# 填写你的hugo版本，可用hugo version查看&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#f92672&#34;&gt;extended&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;           &lt;span style=&#34;color:#75715e&#34;&gt;# 如果你使用的不是extended版本的hugo，将true改为false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Build&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           &lt;span style=&#34;color:#f92672&#34;&gt;run&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;hugo&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Deploy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           &lt;span style=&#34;color:#f92672&#34;&gt;uses&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;peaceiris/actions-gh-pages@v3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           &lt;span style=&#34;color:#f92672&#34;&gt;if&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${{ github.ref == &amp;#39;refs/heads/main&amp;#39; }} &lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# 注意填写main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           &lt;span style=&#34;color:#f92672&#34;&gt;with&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#f92672&#34;&gt;personal_token&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${{ secrets.ACCESS_TOKEN}}&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# 如果secret取了其他名称，将ACCESS_TOKEN替换掉&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#f92672&#34;&gt;external_repository&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;yourname/yourname.github.io&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# 填写远程仓库，不一定是这个格式，按照自己的情况写 &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#f92672&#34;&gt;publish_dir&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;./public&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#75715e&#34;&gt;#cname: www.example.com        # 填写你的自定义域名。如果没有用自定义域名，注释掉这行&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;6. 配置yourname.github.io仓库GitHub Pages&lt;/strong&gt;&lt;br&gt;
打开公有库 &amp;gt; Settings &amp;gt; Pages &amp;gt; Branch 选择gh-pages 分支 &amp;gt; 点击Visit site 即可访问基于GitHub Pages 托管的博客网站。&lt;/p&gt;
&lt;h3 id=&#34;3-总结&#34;&gt;3. 总结&lt;/h3&gt;
&lt;p&gt;参照上述步骤完成了基于GitHub Pages托管博客网站。以后每次往blog私有库mian分支推送代码都可以自动实现上述2个网站内容的自动更新，至此我的个人博客主流程也就告一段落了。&lt;/p&gt;
&lt;h2 id=&#34;四关联搜索引擎&#34;&gt;四、关联搜索引擎&lt;/h2&gt;
&lt;p&gt;上面步骤已经实现了输入网址访问博客，如果希望能大家通过搜索引擎检索到自己的博客，那么还需要让搜索引擎收录我们的博客。下面会选择谷歌和百度两种方式。&lt;/p&gt;
&lt;h3 id=&#34;1-谷歌收录&#34;&gt;1. 谷歌收录&lt;/h3&gt;
&lt;p&gt;查看&lt;a href=&#34;https://gs.statcounter.com/search-engine-market-share&#34;&gt;statcounter网站&lt;/a&gt;可以看到过去一年全球浏览器市场份额，谷歌是遥遥领先的。所以谷歌理所当然成了首选。&lt;/p&gt;
&lt;p&gt;下面会整理谷歌收录步骤：&lt;br&gt;
&lt;strong&gt;1. &lt;a href=&#34;https://search.google.com/search-console/welcome?hl=zh-CN&#34;&gt;打开谷歌收录网站&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. 选择网址前缀配置方式&lt;/strong&gt;&lt;br&gt;
输入博客网址 &amp;gt; 继续&lt;br&gt;
&lt;img src=&#34;images/google_config.png&#34; alt=&#34;配置&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. 网站验证&lt;/strong&gt;&lt;br&gt;
需要验证该网站是我们的，有多种验证方式，我们选择HTML文件的方式。&lt;br&gt;
下载此文件 &amp;gt; 保存至blog/static目录下&lt;br&gt;
当执行hugo转换命令时就会将该文件转换至public目录下，我们就达到了验证的目的。&lt;br&gt;
&lt;img src=&#34;images/google_checking.png&#34; alt=&#34;验证&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. 提交站点地图&lt;/strong&gt;&lt;br&gt;
Sitemaps &amp;gt; 输入 sitemap.xml&lt;br&gt;
sitemap.xml 为站点地图，hugo转换生成的public目录下有该文件。&lt;br&gt;
&lt;img src=&#34;images/google_sitemap.png&#34; alt=&#34;站点地图&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5. 收录成功&lt;/strong&gt;&lt;br&gt;
一段时间后可以通过谷歌检索site:yourwebsite.com来确定收录情况及查阅浏览情况。&lt;/p&gt;
&lt;h3 id=&#34;2-百度收录&#34;&gt;2. 百度收录&lt;/h3&gt;
&lt;p&gt;国内更多的是使用百度，所以第二个选择了被百度收录。
百度收录步骤与谷歌类似其中&lt;a href=&#34;https://ziyuan.baidu.com/site/index&#34;&gt;百度收录网站&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;五尾注&#34;&gt;五、尾注&lt;/h2&gt;
&lt;p&gt;结合&lt;a href=&#34;post/hugo/hugoblog/&#34;&gt;上篇文章&lt;/a&gt;已经完成个人博客服务的完整流程，这个过程让我意识到当前云服务的强大，切实感受到了在不用关心底层架构的便利性。持续集成与持续部署带来的体验便是编码人员或是创作人员，只需要编写代码提交代码，其他的交由CI/CD流水线帮我们编译、部署、上线。&lt;/p&gt;
&lt;p&gt;接下来的创作灵感，也可以基于强大的云平台助力自己的idea快速实现，配置固定的流水线帮助自己快速集成发布减少重复性工作。既然关于“博客”话题的整理流程已经梳理完毕，关于使用的细节等内容可能短期内不再梳理，得等到合适的时机。&lt;/p&gt;
&lt;p&gt;最后附上博客部署的简略流程：&lt;br&gt;
&lt;img src=&#34;images/flow.png&#34; alt=&#34;流程&#34;&gt;&lt;/p&gt;</description>
      
    </item>
    
    <item>
      <title>关于</title>
      <link>https://blog.emath.top/about/</link>
      <pubDate>Tue, 17 Oct 2023 21:38:52 +0800</pubDate>
      
      <guid>https://blog.emath.top/about/</guid>
      
        <description>&lt;h2 id=&#34;博客目的&#34;&gt;博客目的&lt;/h2&gt;
&lt;p&gt;记录自己感兴趣的技术内容与个人实践内容。希望通过博客的方式，养成记笔记的习惯，加深自己对技术的理解。&lt;/p&gt;
&lt;p&gt;不高估自己一年的成长，也不低估自己十年的成长。不断积累以减缓自己被社会淘汰的速度，生易，活易，生活不易。&lt;/p&gt;
</description>
      
    </item>
    
  </channel>
</rss>
